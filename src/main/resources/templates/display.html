<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>카페 주문 시스템</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap');

        body {
            font-family: 'Nanum Gothic', sans-serif;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            height: 100vh;
            margin: 0;
            padding: 20px;
            background-color: #3e2f2f;
            color: #fff;
            box-sizing: border-box;
            overflow: hidden; /* 스크롤바 숨김 */
        }
        .container {
            display: flex;
            flex-direction: column;
            height: 100%;
            justify-content: space-between;
            width: 45%;
        }
        .menu, .orders, .info {
            background-color: #3e2f2f;
            border: 2px solid #fff;
            border-radius: 8px;
            padding: 20px 30px;
            box-sizing: border-box;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        .menu h1, .orders h2, .info h2 {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #fff;
        }
        .menu ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .menu li {
            padding: 15px 0;
            border-bottom: 1px solid #fff;
            font-size: 2rem;
            text-align: right;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0 30px;
        }
        .menu .ice, .menu .hot, .menu .none {
            margin-left: 10px;
        }
        .menu .ice {
            color: blue;
        }
        .menu .hot {
            color: red;
        }
        .menu .none {
            color: #3e2f2f;
        }
        .order-number {
            font-size: 5rem;
            font-weight: bold;
            color: #d32f2f;
            text-align: center;
            margin-bottom: 20px;
        }
        .orders h2 {
            font-size: 3rem;
        }
        .orders .order-boxes {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        .order-box {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
            background: #5c4033;
            border-radius: 4px;
            width: 18%; /* 한 줄에 5개가 들어가도록 너비 조정 */
            text-align: center;
            padding: 10px 0; /* 패딩 조정 */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            color: #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .order-id {
            font-size: 2rem; /* 글꼴 크기 조정 */
        }
        .order-name {
            font-size: 1rem; /* 글꼴 크기 조정 */
            margin-top: 5px;
            color: #ffd700;
        }
        .info {
            margin-top: 20px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* 왼쪽 정렬 설정 */
        }
        .info h2 {
            font-size: 3rem;
        }
        .info div {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .info img {
            width: 50px;
            vertical-align: middle;
            margin-right: 10px;
        }
        .info span {
            vertical-align: middle;
            font-size: 2rem;
        }
        .right-section {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 100%;
            width: 45%;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="menu">
        <h1>메뉴판</h1>
        <ul>
            <li><span>아메리카노</span><span><span class="ice">ICE</span> <span class="hot">HOT</span> - 1,000원</span></li>
            <li><span>카푸치노</span><span><span class="ice">ICE</span> <span class="hot">HOT</span> - 1,500원</span></li>
            <li><span>라떼</span><span><span class="ice">ICE</span> <span class="hot">HOT</span> - 1,500원</span></li>
            <li><span>카페모카</span><span><span class="ice">ICE</span> <span class="hot">HOT</span> - 1,500원</span></li>
            <li><span>카라멜 마끼야또</span><span><span class="ice">ICE</span> <span class="hot">HOT</span> - 2,000원</span></li>
            <li><span>초코라떼</span><span><span class="ice">ICE</span> <span class="hot">HOT</span> - 2,000원</span></li>
            <li><span>블루레몬에이드</span><span><span class="ice">ICE</span> <span class="none">HOT</span> - 2,000원</span></li>
            <li><span>녹차라떼</span><span><span class="ice">ICE</span> <span class="hot">HOT</span> - 2,000원</span></li>
            <li><span>바닐라라떼</span><span><span class="ice">ICE</span> <span class="hot">HOT</span> - 2,000원</span></li>
            <li><span>복숭아티</span><span><span class="ice">ICE</span> <span class="none">HOT</span> - 1,000원</span></li>
            <li><span>오설녹차</span><span><span class="hot">HOT</span> - 1,000원</span></li>
        </ul>
    </div>
</div>
<div class="container right-section">
    <div class="orders">
        <div class="completed-orders">
            <h2>완료된 주문</h2>
            <div class="order-boxes">
                <div id="completedOrder1" class="order-box">
                    <span class="order-id">-</span>
                    <span class="order-name"></span>
                </div>
                <div id="completedOrder2" class="order-box">
                    <span class="order-id">-</span>
                    <span class="order-name"></span>
                </div>
                <div id="completedOrder3" class="order-box">
                    <span class="order-id">-</span>
                    <span class="order-name"></span>
                </div>
                <div id="completedOrder4" class="order-box">
                    <span class="order-id">-</span>
                    <span class="order-name"></span>
                </div>
                <div id="completedOrder5" class="order-box">
                    <span class="order-id">-</span>
                    <span class="order-name"></span>
                </div>
            </div>
        </div>
        <div class="pending-orders">
            <h2>대기 중인 주문</h2>
            <div class="order-boxes">
                <div id="pendingOrder1" class="order-box">
                    <span class="order-id">-</span>
                    <span class="order-name"></span>
                </div>
                <div id="pendingOrder2" class="order-box">
                    <span class="order-id">-</span>
                    <span class="order-name"></span>
                </div>
                <div id="pendingOrder3" class="order-box">
                    <span class="order-id">-</span>
                    <span class="order-name"></span>
                </div>
                <div id="pendingOrder4" class="order-box">
                    <span class="order-id">-</span>
                    <span class="order-name"></span>
                </div>
                <div id="pendingOrder5" class="order-box">
                    <span class="order-id">-</span>
                    <span class="order-name"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="info">
        <div id="weather">
            <img id="weather-img" src="/images/weather-icon.png" alt="Weather Icon">
            <span id="weather-info">날씨 정보 추가 예정..</span>
        </div>
        <div id="clock">
            <img src="/images/clock-icon.png" alt="Clock Icon">
            <span id="datetime-info">시계</span>
        </div>
    </div>
</div>
<script>
    async function fetchOrders() {
        try {
            const completedResponse = await fetch('/api/cafe/completed-orders');
            const pendingResponse = await fetch('/api/cafe/orders');

            if (completedResponse.ok && pendingResponse.ok) {
                const completedOrders = await completedResponse.json();
                const pendingOrders = await pendingResponse.json();

                updateCompletedOrders(completedOrders);
                updatePendingOrders(pendingOrders);
            } else {
                console.error('Failed to fetch orders');
            }
        } catch (error) {
            console.error('Error:', error);
        }
    }

    function updateCompletedOrders(orders) {
        for (let i = 0; i < orders.length && i < 5; i++) {
            const orderBox = document.getElementById(`completedOrder${i + 1}`);
            orderBox.querySelector('.order-id').textContent = orders[i].orderId;
            orderBox.querySelector('.order-name').textContent = orders[i].coffeeName;
        }

        for (let i = orders.length; i < 5; i++) {
            const orderBox = document.getElementById(`completedOrder${i + 1}`);
            orderBox.querySelector('.order-id').textContent = '-';
            orderBox.querySelector('.order-name').textContent = '';
        }
    }

    function updatePendingOrders(orders) {
        for (let i = 0; i < 5; i++) {
            const orderBox = document.getElementById(`pendingOrder${i+1}`);
            if (orders[i]) {
                orderBox.querySelector('.order-id').textContent = orders[i].orderId;
                orderBox.querySelector('.order-name').textContent = orders[i].coffeeName;
            } else {
                orderBox.querySelector('.order-id').textContent = '-';
                orderBox.querySelector('.order-name').textContent = '';
            }
        }
    }

    function updateTime() {
        const now = new Date();
        const dayOfWeek = ['일', '월', '화', '수', '목', '금', '토'];
        const day = dayOfWeek[now.getDay()];
        const dateInfo = document.getElementById('datetime-info');
        const formattedDateTime = `${now.toLocaleDateString('ko-KR')}(${day}) ${now.toLocaleTimeString('ko-KR')}`;
        const formattedDateTimeWithoutSeconds = formattedDateTime.slice(0, -3);
        dateInfo.textContent = formattedDateTimeWithoutSeconds;
    }


    async function updateWeather() {
        try {
            const response = await fetch('/api/weather');
            if (response.ok) {
                const weatherData = await response.json();
                const weatherInfo = document.getElementById('weather-info');
                const weatherImg = document.getElementById('weather-img');

                const temperature = weatherData.temp;
                const condition = weatherData.sky;
                const time = weatherData.time;

                let formattedTime = `${time}:00`;

                weatherInfo.textContent = `${temperature}°C  ${condition}  (${formattedTime}시 기준)`;

                let imgSrc = '';
                switch (condition) {
                    case '맑음':
                        imgSrc = '/images/sunny.png';
                        break;
                    case '비':
                        imgSrc = '/images/rainy.png';
                        break;
                    case '흐림':
                        imgSrc = '/images/cloudy.png';
                        break;
                    case '구름':
                        imgSrc = '/images/partly_cloudy.png';
                        break;
                    default:
                        imgSrc = '/images/default.png';
                }

                weatherImg.src = imgSrc;
                weatherImg.alt = condition;
            } else {
                console.error('Failed to fetch weather data');
            }
        } catch (error) {
            console.error('Error:', error);
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        fetchOrders();
        updateTime();
        updateWeather();

        setInterval(fetchOrders, 5000);
        setInterval(updateTime, 1000);
        setInterval(updateWeather, 600000);
    });
</script>
</body>
</html>
